<script src="jquery.js"></script>
<script>
// Verifica√ß√£o ANTES de carregar QUALQUER coisa
(function() {
    console.log("üîç DEBUG - Verificando disponibilidade da falta na p√°gina:");
    console.log("üìä falta_disponivel (p√°gina atual):", typeof falta_disponivel !== 'undefined' ? falta_disponivel : 'undefined');
    console.log("üìä falta_disponivel (p√°gina pai):", typeof window.parent.falta_disponivel !== 'undefined' ? window.parent.falta_disponivel : 'undefined');
    
    // Verificar se a falta est√° dispon√≠vel
    if (typeof falta_disponivel !== 'undefined' && !falta_disponivel) {
        console.log("üö´ Falta indispon√≠vel, redirecionando para p√°gina principal");
        // Redirecionar imediatamente para a p√°gina inicial
        window.parent.location.href = '../../index.php';
        return; // Para a execu√ß√£o aqui
    } else if (typeof window.parent.falta_disponivel !== 'undefined' && !window.parent.falta_disponivel) {
        console.log("üö´ Falta indispon√≠vel na p√°gina pai, redirecionando para p√°gina principal");
        // Redirecionar imediatamente para a p√°gina inicial
        window.parent.location.href = '../../index.php';
        return; // Para a execu√ß√£o aqui
    } else {
        console.log("‚úÖ Falta dispon√≠vel, carregando p√°gina normalmente");
    }
})();

// Carregar o status VIP e tempo restante dinamicamente
$(document).ready(function() {
    // Carregar status VIP
    $.ajax({
        url: 'get_status.php',
        type: 'GET',
        success: function(data) {
            $('#status_nerfar').val(data);
        },
        error: function() {
            $('#status_nerfar').val('0'); // Fallback para usu√°rio normal
        }
    });
    
    // Carregar tempo restante da falta
    $.ajax({
        url: 'tempof2.php',
        type: 'GET',
        success: function(data) {
            $('#tempo_restante_falta').val(data);
            console.log("‚è∞ Tempo restante da falta carregado:", data);
            
            // Se o tempo j√° zerou, liberar a falta
            if (data === "00:00" || data === "0:0") {
                console.log("‚è∞ Tempo da falta j√° zerou, liberando...");
                if (typeof liberarFalta === 'function') {
                    liberarFalta();
                }
            }
        },
        error: function() {
            $('#tempo_restante_falta').val('0');
            console.log("‚ùå Erro ao carregar tempo da falta");
        }
    });
});
</script>
<script src="scriptfalta.js"></script>
<link type="text/css" rel="stylesheet" href="media/css/style6.css">

<div id="passe_certo_swf" style="margin-left: 20px;">
    <section id="pfalta">
        <input type="hidden" id="status_nerfar" value="">
        <div id="base_user" style="display:none"></div>
        <div id="base_extras" style="display:none"></div>
        <div id="comemoracao" style="display:none"></div>
        <div id="time_chute2" style="display:none"></div>
        <div id="hidden" style="display:none"></div>

        <div id="fundo_f">
            <div id="goleiro" style="background-image: url('img/lacanco.gif');"></div>
            <div id="barreira"></div>
            <div id="chute_esquerda" class="chute" onclick="falta_esquerda();"></div>
            <div id="chute_meio" class="chute" onclick="falta_meio();"></div>
            <div id="chute_direita" class="chute" onclick="falta_direita();"></div>
            <input type="hidden" id="habilidade" value="5">
            <input type="hidden" id="cfalta" value="7379">
            <input type="hidden" id="habilidade_falta" value="0">
            <input type="hidden" id="som_falta" value="0">
            <input type="hidden" id="tempo_restante_falta" value="0">
            <img src="img/bola.png" class="bola" id="imgs" name="logo" alt="Soccer ball">
        </div>
        <div id="goool">
            <div id="conteudo_gol"></div>
            <div id="tente"></div>
            <div id="novamente"></div>
        </div>
    </section>
</div>

<script>
    // Fun√ß√£o para redirecionar ap√≥s anima√ß√£o completa
    function redirecionarAposAnimacao() {
        setTimeout(function() {
            // Redirecionar para a p√°gina inicial ap√≥s 3 segundos
            window.parent.location.href = '../../index.php';
        }, 3000);
    }
    
    // Sobrescrever as fun√ß√µes de comemora√ß√£o para adicionar redirecionamento
    $(document).ready(function() {
        // Interceptar quando a anima√ß√£o de gol ou erro √© mostrada
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'childList') {
                    const addedNodes = Array.from(mutation.addedNodes);
                    addedNodes.forEach(function(node) {
                        if (node.id === 'goool' && node.style.display !== 'none') {
                            // Anima√ß√£o de gol ou erro foi mostrada, iniciar redirecionamento
                            redirecionarAposAnimacao();
                        }
                    });
                }
            });
        });
        
        // Observar mudan√ßas no elemento goool
        const goool = document.getElementById('goool');
        if (goool) {
            observer.observe(goool, { childList: true, subtree: true, attributes: true });
        }
        
        // Tamb√©m observar mudan√ßas de display
        const observerDisplay = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                    const goool = document.getElementById('goool');
                    if (goool && goool.style.display !== 'none') {
                        // goool foi mostrado, iniciar redirecionamento
                        redirecionarAposAnimacao();
                    }
                }
            });
        });
        
        if (goool) {
            observerDisplay.observe(goool, { attributes: true });
        }
    });
</script>